var __extends=this&&this.__extends||function(){var n=function(t,e){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a))t[a]=e[a]};return n(t,e)};return function(t,e){if(typeof e!=="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");n(t,e);function a(){this.constructor=t}t.prototype=e===null?Object.create(e):(a.prototype=e.prototype,new a)}}();var wxmi;(function(t){var a=window["wx"];var n=function(n){__extends(t,n);function t(){var t=n.call(this)||this;var e=Laya.Browser.window.sharedCanvas;if(e){if(!e._addReference){e._addReference=function(){}}var a=new Laya.Texture(e);a.bitmap.alwaysChange=true;t.graphics.drawTexture(a,0,0,a.width,a.height);t.on(Laya.Event.DISPLAY,t,t.onDisplay);t.on(Laya.Event.UNDISPLAY,t,t.onDisplay)}return t}t.prototype.onDisplay=function(){};return t}(Laya.Sprite);function e(e){var t=a.getGameServerManager();t.login().then(function(){t.startStateService({userState:"start",success:function(){a.postMessage({type:3})},fail:function(t){console.error("开启状态管理服务失败",t);if(e){e(t)}}})}).catch(function(t){console.warn("游戏服务登录失败",t);if(e){e(t)}})}var i=function(){function t(){this.isOpen=false}t.prototype.open=function(t){this.initStage();var e=t.parent;t.parent=undefined;a.postMessage({type:1,expandData:t});if(!this.drawSprite){this.drawSprite=new n}if(e){e.addChild(this.drawSprite)}else{Laya.stage.addChild(this.drawSprite)}};t.prototype.initStage=function(){var t=Laya.Browser.window.sharedCanvas;t.width=Laya.stage.width;t.height=Laya.stage.height;if(!this.isOpen){a.postMessage({type:-1,data:{width:Laya.stage.width,height:Laya.stage.height,matrix:Laya.stage._canvasTransform}});this.isOpen=true}};t.prototype.clear=function(){var t=Laya.Browser.window.sharedCanvas;t.width=1;t.height=1;a.postMessage({type:0});if(this.drawSprite){this.drawSprite.removeSelf()}};return t}();var r=function(e){__extends(t,e);function t(){var t=e.call(this)||this;t.closeBtn=new Laya.Sprite;t.graphics.drawRect(0,0,Laya.stage.width,Laya.stage.height,"#00ff00");t.addChild(t.closeBtn);return t}t.prototype.onClose=function(){this.closeBtn.off(Laya.Event.CLICK,this,this.onClose);this.removeSelf();s.clear()};t.prototype.setCloseBtn=function(t,e,a,n){this.hitArea=new Laya.Rectangle(0,0,Laya.stage.width,Laya.stage.height);this.closeBtn.x=t;this.closeBtn.y=e;this.closeBtn.graphics.drawRect(0,0,a,n,"#ff0000");this.closeBtn.hitArea=new Laya.Rectangle(0,0,a,n);this.closeBtn.on(Laya.Event.CLICK,this,this.onClose)};return t}(Laya.Sprite);var s=new i;window["tr_wx_getFriendsList"]=e;window["tr_wx_openSub"]=function(t){if(typeof t=="string"&&t==="clearCanvas"){s.clear()}else{s.open(t)}};window["tr_wx_ui"]=function(t,e){a.postMessage({type:4,ui:t,vis:e})}})(wxmi||(wxmi={}));